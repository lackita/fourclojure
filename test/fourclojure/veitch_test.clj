(ns fourclojure.veitch-test
  (:require [clojure.test :refer :all]
            [fourclojure.veitch :refer :all]))

;; (deftest gray-codes-test
;;   (is (= (gray-codes []) [#{}]))
;;   (is (= (gray-codes ['a]) '[#{a} #{A}]))
;;   (is (= (gray-codes ['a 'B]) '[#{a b} #{a B} #{A B} #{A b}]))
;;   )

;; (deftest kmap-test
;;   (is (= (kmap-for ['[a] '[b]]
;;                    #{#{'A 'B}
;;                      #{'a 'b}})
;;          [[1 0]
;;           [0 1]]))
;;   (is (= (kmap-for ['[a] '[b]]
;;                    #{#{'A 'B}})
;;          [[0 0]
;;           [0 1]]))
;;   (is (= (kmap-for ['[a] '[b]]
;;                    #{#{'a 'b}})
;;          [[1 0]
;;           [0 0]]))
;;   (is (= (kmap-for ['[a] '[b]]
;;                    #{#{'A 'b}
;;                      #{'a 'B}})
;;          [[0 1]
;;           [1 0]]))
;;   (is (= (kmap-for ['[a b] '[c]]
;;                    #{#{'A 'B 'C}})
;;          [[0 0 0 0]
;;           [0 0 1 0]]))
;;   (is (= (kmap-for ['[a b] '[c]]
;;                    #{#{'A 'B 'C}
;;                      #{'A 'b 'C}})
;;          [[0 0 0 0]
;;           [0 0 1 1]]))
;;   (is (= (kmap-for ['[a b] '[c]]
;;                    #{#{'A 'b 'C}})
;;          [[0 0 0 0]
;;           [0 0 0 1]])))

;; (deftest boxes-sized-test
;;   (is (= (boxes-sized [[0 0]
;;                        [0 0]] 2)
;;          '#{[#{b} #{0}]
;;             [#{B} #{0}]
;;             [#{a} #{0}]
;;             [#{A} #{0}]}))
;;   (is (= (boxes-sized [[1 0]
;;                        [0 0]] 2)
;;          '#{[#{b} #{1 0}]
;;             [#{B} #{0}]
;;             [#{a} #{1 0}]
;;             [#{A} #{0}]}))
;;   (is (= (boxes-sized [[0 1]
;;                        [0 0]] 2)
;;          '#{[#{b} #{0 1}]
;;             [#{B} #{0}]
;;             [#{a} #{0}]
;;             [#{A} #{1 0}]}))
;;   (is (= (boxes-sized [[0 0]
;;                        [0 1]] 2)
;;          '#{[#{b} #{0}]
;;             [#{B} #{0 1}]
;;             [#{a} #{0}]
;;             [#{A} #{0 1}]}))
;;   (is (= (boxes-sized [[0 0 0 0]
;;                        [0 0 0 0]] 2)
;;          '#{[#{a c} #{0}]
;;             [#{B c} #{0}]
;;             [#{A c} #{0}]
;;             [#{b c} #{0}]
;;             [#{a C} #{0}]
;;             [#{B C} #{0}]
;;             [#{A C} #{0}]
;;             [#{b C} #{0}]
;;             [#{a b} #{0}]
;;             [#{a B} #{0}]
;;             [#{A B} #{0}]
;;             [#{A b} #{0}]}))
;;   (is (= (boxes-sized [[1 0 0 0]
;;                        [0 0 0 0]] 2)
;;          '#{[#{a c} #{1 0}]
;;             [#{B c} #{0}]
;;             [#{A c} #{0}]
;;             [#{b c} #{0 1}]
;;             [#{a C} #{0}]
;;             [#{B C} #{0}]
;;             [#{A C} #{0}]
;;             [#{b C} #{0}]
;;             [#{a b} #{1 0}]
;;             [#{a B} #{0}]
;;             [#{A B} #{0}]
;;             [#{A b} #{0}]}))
;;   (is (= (boxes-sized [[0 1 0 0]
;;                        [0 0 0 0]] 2)
;;          '#{[#{a c} #{0 1}]
;;             [#{B c} #{1 0}]
;;             [#{A c} #{0}]
;;             [#{b c} #{0}]
;;             [#{a C} #{0}]
;;             [#{B C} #{0}]
;;             [#{A C} #{0}]
;;             [#{b C} #{0}]
;;             [#{a b} #{0}]
;;             [#{a B} #{1 0}]
;;             [#{A B} #{0}]
;;             [#{A b} #{0}]}))
;;   (is (= (boxes-sized [[0 0 1 0]
;;                        [0 0 0 0]] 2)
;;          '#{[#{a c} #{0}]
;;             [#{B c} #{0 1}]
;;             [#{A c} #{1 0}]
;;             [#{b c} #{0}]
;;             [#{a C} #{0}]
;;             [#{B C} #{0}]
;;             [#{A C} #{0}]
;;             [#{b C} #{0}]
;;             [#{a b} #{0}]
;;             [#{a B} #{0}]
;;             [#{A B} #{1 0}]
;;             [#{A b} #{0}]}))
;;   (is (= (boxes-sized [[0 0 0 1]
;;                        [0 0 0 0]] 2)
;;          '#{[#{a c} #{0}]
;;             [#{B c} #{0}]
;;             [#{A c} #{0 1}]
;;             [#{b c} #{1 0}]
;;             [#{a C} #{0}]
;;             [#{B C} #{0}]
;;             [#{A C} #{0}]
;;             [#{b C} #{0}]
;;             [#{a b} #{0}]
;;             [#{a B} #{0}]
;;             [#{A B} #{0}]
;;             [#{A b} #{1 0}]}))
;;   (is (= (boxes-sized [[0 0 0 0]
;;                        [1 0 0 0]] 2)
;;          '#{[#{a c} #{0}]
;;             [#{B c} #{0}]
;;             [#{A c} #{0}]
;;             [#{b c} #{0}]
;;             [#{a C} #{1 0}]
;;             [#{B C} #{0}]
;;             [#{A C} #{0}]
;;             [#{b C} #{0 1}]
;;             [#{a b} #{0 1}]
;;             [#{a B} #{0}]
;;             [#{A B} #{0}]
;;             [#{A b} #{0}]}))
;;   (is (= (boxes-sized [[0 0 0 0]
;;                        [0 1 0 0]] 2)
;;          '#{[#{a c} #{0}]
;;             [#{B c} #{0}]
;;             [#{A c} #{0}]
;;             [#{b c} #{0}]
;;             [#{a C} #{0 1}]
;;             [#{B C} #{1 0}]
;;             [#{A C} #{0}]
;;             [#{b C} #{0}]
;;             [#{a b} #{0}]
;;             [#{a B} #{0 1}]
;;             [#{A B} #{0}]
;;             [#{A b} #{0}]}))
;;   (is (= (boxes-sized [[0 0 0 0]
;;                        [0 0 1 0]] 2)
;;          '#{[#{a c} #{0}]
;;             [#{B c} #{0}]
;;             [#{A c} #{0}]
;;             [#{b c} #{0}]
;;             [#{a C} #{0}]
;;             [#{B C} #{0 1}]
;;             [#{A C} #{1 0}]
;;             [#{b C} #{0}]
;;             [#{a b} #{0}]
;;             [#{a B} #{0}]
;;             [#{A B} #{0 1}]
;;             [#{A b} #{0}]}))
;;   (is (= (boxes-sized [[0 0 0 0]
;;                        [0 0 0 0]] 4)
;;          '#{[#{c} #{0}]
;;             [#{C} #{0}]
;;             [#{a} #{0}]
;;             [#{A} #{0}]
;;             [#{b} #{0}]
;;             [#{B} #{0}]}))
;;   )

;; (deftest rectangle-positions-test
;;   (is (= (rectangle-positions 2 2 2)
;;          #{#{[0 0] [1 0]}
;;            #{[0 1] [1 1]}
;;            #{[0 0] [0 1]}
;;            #{[1 0] [1 1]}}))
;;   (is (= (rectangle-positions 2 2 4)
;;          #{#{[0 0] [0 1] [1 0] [1 1]}}))
;;   (is (= (rectangle-positions 4 2 2)
;;          #{#{[0 0] [1 0]}
;;            #{[1 0] [2 0]}
;;            #{[2 0] [3 0]}
;;            #{[3 0] [0 0]}
;;            #{[0 1] [1 1]}
;;            #{[1 1] [2 1]}
;;            #{[2 1] [3 1]}
;;            #{[3 1] [0 1]}
;;            #{[0 0] [0 1]}
;;            #{[1 0] [1 1]}
;;            #{[2 0] [2 1]}
;;            #{[3 0] [3 1]}}))
;;   (is (= (rectangle-positions 4 2 4)
;;          #{#{[0 0] [1 0] [2 0] [3 0]}
;;            #{[0 1] [1 1] [2 1] [3 1]}
;;            #{[0 0] [1 0] [0 1] [1 1]}
;;            #{[1 0] [2 0] [1 1] [2 1]}
;;            #{[2 0] [3 0] [2 1] [3 1]}
;;            #{[3 0] [0 0] [3 1] [0 1]}}))
;;   (is (= (rectangle-positions 4 4 2)
;;          #{#{[0 0] [1 0]} #{[1 0] [2 0]} #{[2 0] [3 0]} #{[3 0] [0 0]}
;;            #{[0 1] [1 1]} #{[1 1] [2 1]} #{[2 1] [3 1]} #{[3 1] [0 1]}
;;            #{[0 2] [1 2]} #{[1 2] [2 2]} #{[2 2] [3 2]} #{[3 2] [0 2]}
;;            #{[0 3] [1 3]} #{[1 3] [2 3]} #{[2 3] [3 3]} #{[3 3] [0 3]}
;;            #{[0 0] [0 1]} #{[0 1] [0 2]} #{[0 2] [0 3]} #{[0 3] [0 0]}
;;            #{[1 0] [1 1]} #{[1 1] [1 2]} #{[1 2] [1 3]} #{[1 3] [1 0]}
;;            #{[2 0] [2 1]} #{[2 1] [2 2]} #{[2 2] [2 3]} #{[2 3] [2 0]}
;;            #{[3 0] [3 1]} #{[3 1] [3 2]} #{[3 2] [3 3]} #{[3 3] [3 0]}}))
;;   (is (= (rectangle-positions 4 4 4)
;;          #{#{[0 0] [1 0] [2 0] [3 0]}
;;            #{[0 1] [1 1] [2 1] [3 1]}
;;            #{[0 2] [1 2] [2 2] [3 2]}
;;            #{[0 3] [1 3] [2 3] [3 3]}
;;            #{[0 0] [0 1] [0 2] [0 3]}
;;            #{[1 0] [1 1] [1 2] [1 3]}
;;            #{[2 0] [2 1] [2 2] [2 3]}
;;            #{[3 0] [3 1] [3 2] [3 3]}
;;            #{[0 0] [1 0] [0 1] [1 1]}
;;            #{[1 0] [2 0] [1 1] [2 1]}
;;            #{[2 0] [3 0] [2 1] [3 1]}
;;            #{[3 0] [0 0] [3 1] [0 1]}
;;            #{[0 1] [1 1] [0 2] [1 2]}
;;            #{[1 1] [2 1] [1 2] [2 2]}
;;            #{[2 1] [3 1] [2 2] [3 2]}
;;            #{[3 1] [0 1] [3 2] [0 2]}
;;            #{[0 2] [1 2] [0 3] [1 3]}
;;            #{[1 2] [2 2] [1 3] [2 3]}
;;            #{[2 2] [3 2] [2 3] [3 3]}
;;            #{[3 2] [0 2] [3 3] [0 3]}
;;            #{[0 3] [1 3] [0 0] [1 0]}
;;            #{[1 3] [2 3] [1 0] [2 0]}
;;            #{[2 3] [3 3] [2 0] [3 0]}
;;            #{[3 3] [0 3] [3 0] [0 0]}}))
;;   (is (= (rectangle-positions 4 4 8)
;;          #{#{[0 0] [1 0] [2 0] [3 0]
;;              [0 1] [1 1] [2 1] [3 1]}
;;            #{[0 1] [1 1] [2 1] [3 1]
;;              [0 2] [1 2] [2 2] [3 2]}
;;            #{[0 2] [1 2] [2 2] [3 2]
;;              [0 3] [1 3] [2 3] [3 3]}
;;            #{[0 3] [1 3] [2 3] [3 3]
;;              [0 0] [1 0] [2 0] [3 0]}
;;            #{[0 0] [0 1] [0 2] [0 3]
;;              [1 0] [1 1] [1 2] [1 3]}
;;            #{[1 0] [1 1] [1 2] [1 3]
;;              [2 0] [2 1] [2 2] [2 3]}
;;            #{[2 0] [2 1] [2 2] [2 3]
;;              [3 0] [3 1] [3 2] [3 3]}
;;            #{[3 0] [3 1] [3 2] [3 3]
;;              [0 0] [0 1] [0 2] [0 3]}}))
;;   (is (= (rectangle-positions 4 4 16)
;;          #{#{[0 0] [0 1] [0 2] [0 3]
;;              [1 0] [1 1] [1 2] [1 3]
;;              [2 0] [2 1] [2 2] [2 3]
;;              [3 0] [3 1] [3 2] [3 3]}}))
;;   )

;; (deftest split-symbols-test
;;   (is (= (split-symbols '#{a b}) '[[a] [b]]))
;;   (is (= (split-symbols '#{a b c}) '[[a b] [c]]))
;;   )

(deftest full-function-test
  (is (= ((full-function) #{#{'a 'B 'C 'd}
                            #{'A 'b 'c 'd}
                            #{'A 'b 'c 'D}
                            #{'A 'b 'C 'd}
                            #{'A 'b 'C 'D}
                            #{'A 'B 'c 'd}
                            #{'A 'B 'c 'D}
                            #{'A 'B 'C 'd}})
         #{#{'A 'c}
           #{'A 'b}
           #{'B 'C 'd}}))
  (is (= ((full-function) #{#{'A 'B 'C 'D}
                            #{'A 'B 'C 'd}})
         #{#{'A 'B 'C}}))
  (is (= ((full-function) #{#{'a 'b 'c 'd}
                            #{'a 'B 'c 'd}
                            #{'a 'b 'c 'D}
                            #{'a 'B 'c 'D}
                            #{'A 'B 'C 'd}
                            #{'A 'B 'C 'D}
                            #{'A 'b 'C 'd}
                            #{'A 'b 'C 'D}})
         #{#{'a 'c}
           #{'A 'C}}))
  (is (= ((full-function) #{#{'a 'b 'c}
                            #{'a 'B 'c}
                            #{'a 'b 'C}
                            #{'a 'B 'C}})
         #{#{'a}}))
  (is (= ((full-function) #{#{'a 'B 'c 'd}
                            #{'A 'B 'c 'D}
                            #{'A 'b 'C 'D}
                            #{'a 'b 'c 'D}
                            #{'a 'B 'C 'D}
                            #{'A 'B 'C 'd}})
         #{#{'a 'B 'c 'd}
           #{'A 'B 'c 'D}
           #{'A 'b 'C 'D}
           #{'a 'b 'c 'D}
           #{'a 'B 'C 'D}
           #{'A 'B 'C 'd}}))
  (is (= ((full-function) #{#{'a 'b 'c 'd}
                            #{'a 'B 'c 'd}
                            #{'A 'B 'c 'd}
                            #{'a 'b 'c 'D}
                            #{'a 'B 'c 'D}
                            #{'A 'B 'c 'D}})
         #{#{'a 'c}
           #{'B 'c}}))
  (= ((full-function) #{#{'a 'B 'c 'd}
                        #{'A 'B 'c 'd}
                        #{'a 'b 'c 'D}
                        #{'a 'b 'C 'D}
                        #{'A 'b 'c 'D}
                        #{'A 'b 'C 'D}
                        #{'a 'B 'C 'd}
                        #{'A 'B 'C 'd}})
     #{#{'B 'd}
       #{'b 'D}})
  (= ((full-function) #{#{'a 'b 'c 'd}
                        #{'A 'b 'c 'd}
                        #{'a 'B 'c 'D}
                        #{'A 'B 'c 'D}
                        #{'a 'B 'C 'D}
                        #{'A 'B 'C 'D}
                        #{'a 'b 'C 'd}
                        #{'A 'b 'C 'd}})
     #{#{'B 'D}
       #{'b 'd}})
  )
